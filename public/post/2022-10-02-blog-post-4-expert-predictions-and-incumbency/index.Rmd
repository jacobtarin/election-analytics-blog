---
title: 'Blog Post 4: Expert Predictions and Incumbency'
author: Jacob Moore
date: '2022-10-02'
slug: []
categories: []
tags: []
---

```{r setup, include=FALSE}
library(tidyverse)
library(sf)
library(plotly)

# Reading in data (Thank you to Ethan Jasny for the expert ratings datset)
dist_polls <- read_csv("../data/dist_polls_2018-2022.csv")
incumbents <- read_csv("../data/incumb_dist_1948-2020.csv")
expert_ratings <- read_csv("../data/2018_ratings_share.csv")
historical_results <- read_csv("../data/house party vote share by district 1948-2020.csv")
cd114 <- st_read("../data/districtShapes/districts114.shp", quiet = TRUE)

# Clean election data
election_2018 <- historical_results %>% 
  filter(raceYear == 2018) %>% 
  select(State, raceYear, Area, RepVotesMajorPercent, DemVotesMajorPercent,
         CD, state_abb, district_num, district_id, WinnerParty) %>% 
  mutate(CD = case_when(district_num == 0 ~ paste(state_abb, "01", sep = "-"),
                        district_num != 0 ~ CD))

# Add margin predictions to expert ratings
expert_ratings <- expert_ratings %>% 
  mutate(cpr_margin = case_when(
    cpr == "Solid Democratic" ~ 60,
    cpr == "Likely Democratic" ~ 55,
    cpr == "Lean Democratic" ~ 52.5,
    cpr == "Toss-up" ~ 50,
    cpr == "Lean Republican" ~ 47.5,
    cpr == "Likely Republican" ~ 45,
    cpr == "Solid Republican" ~ 40
  )) %>% 
  mutate(crystal_ball_margin = case_when(
    crystal_ball == "Safe Democratic" ~ 60,
    crystal_ball == "Likely Democratic" ~ 55,
    crystal_ball == "Lean Democratic" ~ 52.5,
    crystal_ball == "Toss-up" ~ 50,
    crystal_ball == "Lean Republican" ~ 47.5,
    crystal_ball == "Likely Republican" ~ 45,
    crystal_ball == "Safe Republican" ~ 40
  )) %>% 
  mutate(inside_elections_margin = case_when(
    inside_elections == "Solid Democratic" ~ 60,
    inside_elections == "Likely Democratic" ~ 55,
    inside_elections == "Lean Democratic" ~ 52.5,
    inside_elections == "Tilt Democratic" ~ 51.5,
    inside_elections == "Toss-up" ~ 50,
    inside_elections == "Tilt Republican" ~ 48.5,
    inside_elections == "Lean Republican" ~ 47.5,
    inside_elections == "Likely Republican" ~ 45,
    inside_elections == "Solid Republican" ~ 40
  )) %>% 
  mutate(avg_margin = (cpr_margin + crystal_ball_margin + inside_elections_margin)/3)

# Join election data and expert ratings
election_2018 <- election_2018 %>% 
  inner_join(expert_ratings, by = c("CD" = "District")) %>% 
  rename(STATENAME = State, DISTRICT = district_num) %>% 
  mutate(DISTRICT = as.character(DISTRICT),
         expert_diff = avg_margin - DemVotesMajorPercent)

# Clean and simplify shapefiles for join
cd114 <- st_make_valid(cd114)
cd114 <- st_simplify(cd114, preserveTopology = TRUE, dTolerance = 1000)
cd114 <- cd114 %>% left_join(election_2018, by = c("DISTRICT", "STATENAME"))

vote_share_actual <- ggplot() + 
  geom_sf(data = cd114, aes(fill = DemVotesMajorPercent),
          inherit.aes = FALSE, alpha = 0.9) + 
  scale_fill_gradient2(low = "red", mid = "#ececec", high = "blue",
                       midpoint = 50, limits = c(0, 100)) +
  coord_sf(xlim = c(-126.43, -66.57), ylim = c(23, 51), expand = FALSE) + 
  theme_void() +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(title = "2018 Democratic Party Vote Share by District",
       fill = "D-Vote %")

vote_share_predicted <- ggplot() + 
  geom_sf(data = cd114, aes(fill = avg_margin),
          inherit.aes = FALSE, alpha = 0.9) + 
  scale_fill_gradient2(low = "red", mid = "#ececec", high = "blue",
                       midpoint = 50, limits = c(0, 100)) +
  coord_sf(xlim = c(-126.43, -66.57), ylim = c(23, 51), expand = FALSE) + 
  theme_void() +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(title = "2018 Expert Predictions",
       fill = "D-Vote %")

vote_share_difference <- ggplot() + 
  geom_sf(data = cd114, aes(fill = expert_diff),
          inherit.aes = FALSE, alpha = 0.9) + 
  scale_fill_gradient2(low = "red", mid = "#ececec", high = "blue",
                       midpoint = 0, limits = c(-40, 40)) +
  coord_sf(xlim = c(-126.43, -66.57), ylim = c(23, 51), expand = FALSE) + 
  theme_void() +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(title = "Expert Prediction Differences",
       fill = "Predicted Minus Actual")
```

This week I'll be looking at expert predictions and incumbency to help build my model for the upcoming 2022 midterm election. I'll start by assessing the accuracy of expert predictions in the 2018 midterm elections before incorporating incumbency and potentially expert predictions into my model.

# Expert Predictions

I am not alone when it comes to attempting to predict the outcomes of elections. There are so many different media outlets, researchers, think tanks, and political hobbyists who attempt to predict the outcomes of elections. I'll be using the predictions from three different sources: the [Cook Political Report](https://www.cookpolitical.com/ratings/house-race-ratings/187562), [Inside Elections](http://www.insideelections.com/ratings/house/2018-house-ratings-september-28-2018), and [Larry Sabato's Crystal Ball](https://insideelections.com/archive/year/2018). While these sources ascribe descriptive values to the outcome of races (solid, lean, etc) all three of them are widely-known and widely respected. What surprised me is that some outlets like FiveThirtyEight incorporate these predictions into their models. Perhaps what these experts are able to capture are things like candidate quality which can be hard to determine based on other data that is out there.

When experts predict the outcome of a race, they give it a descriptor that can roughly correspond to different voteshares. I've chosen to give the following Democrat voteshares to the following predictions:

Solid Democrat - 60%
Likely Democrat - 55%
Lean Democrat - 52.5%
Tilt Democrat - 51.5%
Toss-up - 50%
Tilt Republican - 48.5%
Lean Republican - 47.5%
Likely Republican - 45%
Solid Republican - 40%

Let's look at some maps. The following map shows the two party vote share by district in the 2018 house midterm election:

```{r map1, echo = FALSE, warning = FALSE}
vote_share_actual
```

Plotted below is the average of the expert predictions for each district using the voteshare values I ascribed. 

```{r map2, echo = FALSE, warning = FALSE}
vote_share_predicted
```

And below is a map that shows the difference between expert predictions and actual voteshare outcomes. Note that positive (blue) values indicate that Democrats fared better than experts predicted, and negative (red) values indicate that Democrats fared worse than experts predicted.

```{r map3, echo = FALSE, warning = FALSE}
vote_share_difference
```

As we can see, it looks like Democrats did a little bit better than experts predicted in many of the districts in the 2018 midterm election, with only a few races where Democrats fared worse than expected. There were a few districts which were labeled as strong Democrat/Republican that had a difference of 40 points. While at first it may seem like a gross inaccuracy, these districts are ones where a candidate ran uncontested. Based on how I coded the "strong" values, uncontested races will always put out a margin difference of 40 points. This highlights the arbitrariness of my ascribed values but doesn't take away from the overall trends of these expert predictions, namely that Democrats exceeded expectations.